
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../../../static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../../../static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../../../static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../../../static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../../../static/javascripts/modernizr.js"></script>
  
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-XXXXX"></script>
<script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'UA-XXXXX');
</script>
  
  
    <title>cJSON &#8212; C data struct 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../static/material.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../static/documentation_options.js"></script>
    <script src="../../../static/jquery.js"></script>
    <script src="../../../static/underscore.js"></script>
    <script src="../../../static/doctools.js"></script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=white data-md-color-accent=light-white>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#data/json/cJSON-master/README" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../../index.html" title="C data struct 0.1 documentation"
           class="md-header-nav__button md-logo">
          
            &nbsp;
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">C data struct info</span>
          <span class="md-header-nav__topic"> cJSON </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../../../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/project/project/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    c struct data
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../../../static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../../../"versions.json"",
        target_loc = "../../../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../../../index.html" class="md-tabs__link">C data struct 0.1 documentation</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../../index.html" title="C data struct 0.1 documentation" class="md-nav__button md-logo">
      
        <img src="../../../static/" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../../../index.html"
       title="C data struct 0.1 documentation">C data struct info</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/project/project/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    c struct data
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="../../hash/info.html" class="md-nav__link">I:C语言-哈希查找(HASH)-详解（完整代码）</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../line/info.html" class="md-nav__link">II:C语言描述数据结构 —— 顺序表</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../linkmap/info.html" class="md-nav__link">III:C语言描述数据结构 —— 单链表</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../pushpop/info.html" class="md-nav__link">IV:C语言描述数据结构 —— 栈和队列</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../ring/info.html" class="md-nav__link">V:裸机中环形队列与RTOS中消息队列的区别</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../tree/info.html" class="md-nav__link">VI:平衡二叉树 C语言代码实现</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../time/info.html" class="md-nav__link">VII:定时器方案之红黑树与最小堆、时间轮详解</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../skiplist/info.html" class="md-nav__link">VIII:让你的代码更加优雅的编程技巧-跳转表</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#data-json-cjson-master-readme--page-root" class="md-nav__link">cJSON</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#table-of-contents" class="md-nav__link">Table of contents</a>
        </li>
        <li class="md-nav__item"><a href="#license" class="md-nav__link">License</a>
        </li>
        <li class="md-nav__item"><a href="#usage" class="md-nav__link">Usage</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#welcome-to-cjson" class="md-nav__link">Welcome to cJSON.</a>
        </li>
        <li class="md-nav__item"><a href="#building" class="md-nav__link">Building</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#copying-the-source" class="md-nav__link">copying the source</a>
        </li>
        <li class="md-nav__item"><a href="#cmake" class="md-nav__link">CMake</a>
        </li>
        <li class="md-nav__item"><a href="#makefile" class="md-nav__link">Makefile</a>
        </li>
        <li class="md-nav__item"><a href="#vcpkg" class="md-nav__link">Vcpkg</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#including-cjson" class="md-nav__link">Including cJSON</a>
        </li>
        <li class="md-nav__item"><a href="#data-structure" class="md-nav__link">Data Structure</a>
        </li>
        <li class="md-nav__item"><a href="#working-with-the-data-structure" class="md-nav__link">Working with the data structure</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#basic-types" class="md-nav__link">Basic types</a>
        </li>
        <li class="md-nav__item"><a href="#arrays" class="md-nav__link">Arrays</a>
        </li>
        <li class="md-nav__item"><a href="#objects" class="md-nav__link">Objects</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#parsing-json" class="md-nav__link">Parsing JSON</a>
        </li>
        <li class="md-nav__item"><a href="#printing-json" class="md-nav__link">Printing JSON</a>
        </li>
        <li class="md-nav__item"><a href="#example" class="md-nav__link">Example</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#printing" class="md-nav__link">Printing</a>
        </li>
        <li class="md-nav__item"><a href="#parsing" class="md-nav__link">Parsing</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#caveats" class="md-nav__link">Caveats</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#zero-character" class="md-nav__link">Zero Character</a>
        </li>
        <li class="md-nav__item"><a href="#character-encoding" class="md-nav__link">Character Encoding</a>
        </li>
        <li class="md-nav__item"><a href="#c-standard" class="md-nav__link">C Standard</a>
        </li>
        <li class="md-nav__item"><a href="#floating-point-numbers" class="md-nav__link">Floating Point Numbers</a>
        </li>
        <li class="md-nav__item"><a href="#deep-nesting-of-arrays-and-objects" class="md-nav__link">Deep Nesting Of Arrays And Objects</a>
        </li>
        <li class="md-nav__item"><a href="#thread-safety" class="md-nav__link">Thread Safety</a>
        </li>
        <li class="md-nav__item"><a href="#case-sensitivity" class="md-nav__link">Case Sensitivity</a>
        </li>
        <li class="md-nav__item"><a href="#duplicate-object-members" class="md-nav__link">Duplicate Object Members</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#enjoy-cjson" class="md-nav__link">Enjoy cJSON!</a>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../../../sources/data/json/cJSON-master/README.md.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="cjson">
<h1 id="data-json-cjson-master-readme--page-root">cJSON<a class="headerlink" href="#data-json-cjson-master-readme--page-root" title="Permalink to this headline">¶</a></h1>
<p>Ultralightweight JSON parser in ANSI C.</p>
<section id="table-of-contents">
<h2 id="table-of-contents">Table of contents<a class="headerlink" href="#table-of-contents" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><span class="xref myst">License</span></p></li>
<li><p><span class="xref myst">Usage</span></p>
<ul>
<li><p><span class="xref myst">Welcome to cJSON</span></p></li>
<li><p><span class="xref myst">Building</span></p>
<ul>
<li><p><span class="xref myst">Copying the source</span></p></li>
<li><p><span class="xref myst">CMake</span></p></li>
<li><p><span class="xref myst">Makefile</span></p></li>
<li><p><span class="xref myst">Vcpkg</span></p></li>
</ul>
</li>
<li><p><span class="xref myst">Including cJSON</span></p></li>
<li><p><span class="xref myst">Data Structure</span></p></li>
<li><p><span class="xref myst">Working with the data structure</span></p>
<ul>
<li><p><span class="xref myst">Basic types</span></p></li>
<li><p><span class="xref myst">Arrays</span></p></li>
<li><p><span class="xref myst">Objects</span></p></li>
</ul>
</li>
<li><p><span class="xref myst">Parsing JSON</span></p></li>
<li><p><span class="xref myst">Printing JSON</span></p></li>
<li><p><span class="xref myst">Example</span></p>
<ul>
<li><p><span class="xref myst">Printing</span></p></li>
<li><p><span class="xref myst">Parsing</span></p></li>
</ul>
</li>
<li><p><span class="xref myst">Caveats</span></p>
<ul>
<li><p><span class="xref myst">Zero Character</span></p></li>
<li><p><span class="xref myst">Character Encoding</span></p></li>
<li><p><span class="xref myst">C Standard</span></p></li>
<li><p><span class="xref myst">Floating Point Numbers</span></p></li>
<li><p><span class="xref myst">Deep Nesting Of Arrays And Objects</span></p></li>
<li><p><span class="xref myst">Thread Safety</span></p></li>
<li><p><span class="xref myst">Case Sensitivity</span></p></li>
<li><p><span class="xref myst">Duplicate Object Members</span></p></li>
</ul>
</li>
<li><p><span class="xref myst">Enjoy cJSON!</span></p></li>
</ul>
</li>
</ul>
</section>
<section id="license">
<h2 id="license">License<a class="headerlink" href="#license" title="Permalink to this headline">¶</a></h2>
<p>MIT License</p>
<blockquote>
<div><p>Copyright (c) 2009-2017 Dave Gamble and cJSON contributors</p>
<p>Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the “Software”), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:</p>
<p>The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.</p>
</div></blockquote>
</section>
<section id="usage">
<h2 id="usage">Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<section id="welcome-to-cjson">
<h3 id="welcome-to-cjson">Welcome to cJSON.<a class="headerlink" href="#welcome-to-cjson" title="Permalink to this headline">¶</a></h3>
<p>cJSON aims to be the dumbest possible parser that you can get your job done with.
It’s a single file of C, and a single header file.</p>
<p>JSON is described best here: http://www.json.org/
It’s like XML, but fat-free. You use it to move data around, store things, or just
generally represent your program’s state.</p>
<p>As a library, cJSON exists to take away as much legwork as it can, but not get in your way.
As a point of pragmatism (i.e. ignoring the truth), I’m going to say that you can use it
in one of two modes: Auto and Manual. Let’s have a quick run-through.</p>
<p>I lifted some JSON from this page: http://www.json.org/fatfree.html
That page inspired me to write cJSON, which is a parser that tries to share the same
philosophy as JSON itself. Simple, dumb, out of the way.</p>
</section>
<section id="building">
<h3 id="building">Building<a class="headerlink" href="#building" title="Permalink to this headline">¶</a></h3>
<p>There are several ways to incorporate cJSON into your project.</p>
<section id="copying-the-source">
<h4 id="copying-the-source">copying the source<a class="headerlink" href="#copying-the-source" title="Permalink to this headline">¶</a></h4>
<p>Because the entire library is only one C file and one header file, you can just copy <code class="docutils literal notranslate"><span class="pre">cJSON.h</span></code> and <code class="docutils literal notranslate"><span class="pre">cJSON.c</span></code> to your projects source and start using it.</p>
<p>cJSON is written in ANSI C (C89) in order to support as many platforms and compilers as possible.</p>
</section>
<section id="cmake">
<h4 id="cmake">CMake<a class="headerlink" href="#cmake" title="Permalink to this headline">¶</a></h4>
<p>With CMake, cJSON supports a full blown build system. This way you get the most features. CMake with an equal or higher version than 2.8.5 is supported. With CMake it is recommended to do an out of tree build, meaning the compiled files are put in a directory separate from the source files. So in order to build cJSON with CMake on a Unix platform, make a <code class="docutils literal notranslate"><span class="pre">build</span></code> directory and run CMake inside it.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="n">build</span>
<span class="n">cd</span> <span class="n">build</span>
<span class="n">cmake</span> <span class="o">..</span>
</pre></div>
</div>
<p>This will create a Makefile and a bunch of other files. You can then compile it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make</span>
</pre></div>
</div>
<p>And install it with <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">install</span></code> if you want. By default it installs the headers <code class="docutils literal notranslate"><span class="pre">/usr/local/include/cjson</span></code> and the libraries to <code class="docutils literal notranslate"><span class="pre">/usr/local/lib</span></code>. It also installs files for pkg-config to make it easier to detect and use an existing installation of CMake. And it installs CMake config files, that can be used by other CMake based projects to discover the library.</p>
<p>You can change the build process with a list of different options that you can pass to CMake. Turn them on with <code class="docutils literal notranslate"><span class="pre">On</span></code> and off with <code class="docutils literal notranslate"><span class="pre">Off</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-DENABLE_CJSON_TEST=On</span></code>: Enable building the tests. (on by default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-DENABLE_CJSON_UTILS=On</span></code>: Enable building cJSON_Utils. (off by default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-DENABLE_TARGET_EXPORT=On</span></code>: Enable the export of CMake targets. Turn off if it makes problems. (on by default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-DENABLE_CUSTOM_COMPILER_FLAGS=On</span></code>: Enable custom compiler flags (currently for Clang, GCC and MSVC). Turn off if it makes problems. (on by default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-DENABLE_VALGRIND=On</span></code>: Run tests with <a class="reference external" href="http://valgrind.org">valgrind</a>. (off by default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-DENABLE_SANITIZERS=On</span></code>: Compile cJSON with <a class="reference external" href="https://github.com/google/sanitizers/wiki/AddressSanitizer">AddressSanitizer</a> and <a class="reference external" href="https://clang.llvm.org/docs/UndefinedBehaviorSanitizer.html">UndefinedBehaviorSanitizer</a> enabled (if possible). (off by default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-DENABLE_SAFE_STACK</span></code>: Enable the <a class="reference external" href="https://clang.llvm.org/docs/SafeStack.html">SafeStack</a> instrumentation pass. Currently only works with the Clang compiler. (off by default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-DBUILD_SHARED_LIBS=On</span></code>: Build the shared libraries. (on by default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-DBUILD_SHARED_AND_STATIC_LIBS=On</span></code>: Build both shared and static libraries. (off by default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-DCMAKE_INSTALL_PREFIX=/usr</span></code>: Set a prefix for the installation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-DENABLE_LOCALES=On</span></code>: Enable the usage of localeconv method. ( on by default )</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-DCJSON_OVERRIDE_BUILD_SHARED_LIBS=On</span></code>: Enable overriding the value of <code class="docutils literal notranslate"><span class="pre">BUILD_SHARED_LIBS</span></code> with <code class="docutils literal notranslate"><span class="pre">-DCJSON_BUILD_SHARED_LIBS</span></code>.</p></li>
</ul>
<p>If you are packaging cJSON for a distribution of Linux, you would probably take these steps for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir build
cd build
cmake .. -DENABLE_CJSON_UTILS=On -DENABLE_CJSON_TEST=Off -DCMAKE_INSTALL_PREFIX=/usr
make
make DESTDIR=$pkgdir install
</pre></div>
</div>
<p>On Windows CMake is usually used to create a Visual Studio solution file by running it inside the Developer Command Prompt for Visual Studio, for exact steps follow the official documentation from CMake and Microsoft and use the online search engine of your choice. The descriptions of the the options above still generally apply, although not all of them work on Windows.</p>
</section>
<section id="makefile">
<h4 id="makefile">Makefile<a class="headerlink" href="#makefile" title="Permalink to this headline">¶</a></h4>
<p><strong>NOTE:</strong> This Method is deprecated. Use CMake if at all possible. Makefile support is limited to fixing bugs.</p>
<p>If you don’t have CMake available, but still have GNU make. You can use the makefile to build cJSON:</p>
<p>Run this command in the directory with the source code and it will automatically compile static and shared libraries and a little test program (not the full test suite).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="nb">all</span>
</pre></div>
</div>
<p>If you want, you can install the compiled library to your system using <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">install</span></code>. By default it will install the headers in <code class="docutils literal notranslate"><span class="pre">/usr/local/include/cjson</span></code> and the libraries in <code class="docutils literal notranslate"><span class="pre">/usr/local/lib</span></code>. But you can change this behavior by setting the <code class="docutils literal notranslate"><span class="pre">PREFIX</span></code> and <code class="docutils literal notranslate"><span class="pre">DESTDIR</span></code> variables: <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">PREFIX=/usr</span> <span class="pre">DESTDIR=temp</span> <span class="pre">install</span></code>. And uninstall them with: <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">PREFIX=/usr</span> <span class="pre">DESTDIR=temp</span> <span class="pre">uninstall</span></code>.</p>
</section>
<section id="vcpkg">
<h4 id="vcpkg">Vcpkg<a class="headerlink" href="#vcpkg" title="Permalink to this headline">¶</a></h4>
<p>You can download and install cJSON using the <a class="reference external" href="https://github.com/Microsoft/vcpkg">vcpkg</a> dependency manager:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">Microsoft</span><span class="o">/</span><span class="n">vcpkg</span><span class="o">.</span><span class="n">git</span>
<span class="n">cd</span> <span class="n">vcpkg</span>
<span class="o">./</span><span class="n">bootstrap</span><span class="o">-</span><span class="n">vcpkg</span><span class="o">.</span><span class="n">sh</span>
<span class="o">./</span><span class="n">vcpkg</span> <span class="n">integrate</span> <span class="n">install</span>
<span class="n">vcpkg</span> <span class="n">install</span> <span class="n">cjson</span>
</pre></div>
</div>
<p>The cJSON port in vcpkg is kept up to date by Microsoft team members and community contributors. If the version is out of date, please <a class="reference external" href="https://github.com/Microsoft/vcpkg">create an issue or pull request</a> on the vcpkg repository.</p>
</section>
</section>
<section id="including-cjson">
<h3 id="including-cjson">Including cJSON<a class="headerlink" href="#including-cjson" title="Permalink to this headline">¶</a></h3>
<p>If you installed it via CMake or the Makefile, you can include cJSON like this:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cjson/cJSON.h&gt;</span><span class="cp"></span>
</pre></div>
</div>
</section>
<section id="data-structure">
<h3 id="data-structure">Data Structure<a class="headerlink" href="#data-structure" title="Permalink to this headline">¶</a></h3>
<p>cJSON represents JSON data using the <code class="docutils literal notranslate"><span class="pre">cJSON</span></code> struct data type:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* The cJSON structure: */</span><span class="w"></span>
<span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">cJSON</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">cJSON</span><span class="w"> </span><span class="o">*</span><span class="n">next</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">cJSON</span><span class="w"> </span><span class="o">*</span><span class="n">prev</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">cJSON</span><span class="w"> </span><span class="o">*</span><span class="n">child</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">type</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">valuestring</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="cm">/* writing to valueint is DEPRECATED, use cJSON_SetNumberValue instead */</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">valueint</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">valuedouble</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">string</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">cJSON</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>An item of this type represents a JSON value. The type is stored in <code class="docutils literal notranslate"><span class="pre">type</span></code> as a bit-flag (<strong>this means that you cannot find out the type by just comparing the value of <code class="docutils literal notranslate"><span class="pre">type</span></code></strong>).</p>
<p>To check the type of an item, use the corresponding <code class="docutils literal notranslate"><span class="pre">cJSON_Is...</span></code> function. It does a <code class="docutils literal notranslate"><span class="pre">NULL</span></code> check followed by a type check and returns a boolean value if the item is of this type.</p>
<p>The type can be one of the following:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cJSON_Invalid</span></code> (check with <code class="docutils literal notranslate"><span class="pre">cJSON_IsInvalid</span></code>): Represents an invalid item that doesn’t contain any value. You automatically have this type if you set the item to all zero bytes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cJSON_False</span></code> (check with <code class="docutils literal notranslate"><span class="pre">cJSON_IsFalse</span></code>): Represents a <code class="docutils literal notranslate"><span class="pre">false</span></code> boolean value. You can also check for boolean values in general with <code class="docutils literal notranslate"><span class="pre">cJSON_IsBool</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cJSON_True</span></code> (check with <code class="docutils literal notranslate"><span class="pre">cJSON_IsTrue</span></code>): Represents a <code class="docutils literal notranslate"><span class="pre">true</span></code> boolean value. You can also check for boolean values in general with <code class="docutils literal notranslate"><span class="pre">cJSON_IsBool</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cJSON_NULL</span></code> (check with <code class="docutils literal notranslate"><span class="pre">cJSON_IsNull</span></code>): Represents a <code class="docutils literal notranslate"><span class="pre">null</span></code> value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cJSON_Number</span></code> (check with <code class="docutils literal notranslate"><span class="pre">cJSON_IsNumber</span></code>): Represents a number value. The value is stored as a double in <code class="docutils literal notranslate"><span class="pre">valuedouble</span></code> and also in <code class="docutils literal notranslate"><span class="pre">valueint</span></code>. If the number is outside of the range of an integer, <code class="docutils literal notranslate"><span class="pre">INT_MAX</span></code> or <code class="docutils literal notranslate"><span class="pre">INT_MIN</span></code> are used for <code class="docutils literal notranslate"><span class="pre">valueint</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cJSON_String</span></code> (check with <code class="docutils literal notranslate"><span class="pre">cJSON_IsString</span></code>): Represents a string value. It is stored in the form of a zero terminated string in <code class="docutils literal notranslate"><span class="pre">valuestring</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cJSON_Array</span></code> (check with <code class="docutils literal notranslate"><span class="pre">cJSON_IsArray</span></code>): Represent an array value. This is implemented by pointing <code class="docutils literal notranslate"><span class="pre">child</span></code> to a linked list of <code class="docutils literal notranslate"><span class="pre">cJSON</span></code> items that represent the values in the array. The elements are linked together using <code class="docutils literal notranslate"><span class="pre">next</span></code> and <code class="docutils literal notranslate"><span class="pre">prev</span></code>, where the first element has <code class="docutils literal notranslate"><span class="pre">prev.next</span> <span class="pre">==</span> <span class="pre">NULL</span></code> and the last element <code class="docutils literal notranslate"><span class="pre">next</span> <span class="pre">==</span> <span class="pre">NULL</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cJSON_Object</span></code> (check with <code class="docutils literal notranslate"><span class="pre">cJSON_IsObject</span></code>): Represents an object value. Objects are stored same way as an array, the only difference is that the items in the object store their keys in <code class="docutils literal notranslate"><span class="pre">string</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cJSON_Raw</span></code> (check with <code class="docutils literal notranslate"><span class="pre">cJSON_IsRaw</span></code>): Represents any kind of JSON that is stored as a zero terminated array of characters in <code class="docutils literal notranslate"><span class="pre">valuestring</span></code>. This can be used, for example, to avoid printing the same static JSON over and over again to save performance. cJSON will never create this type when parsing. Also note that cJSON doesn’t check if it is valid JSON.</p></li>
</ul>
<p>Additionally there are the following two flags:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cJSON_IsReference</span></code>: Specifies that the item that <code class="docutils literal notranslate"><span class="pre">child</span></code> points to and/or <code class="docutils literal notranslate"><span class="pre">valuestring</span></code> is not owned by this item, it is only a reference. So <code class="docutils literal notranslate"><span class="pre">cJSON_Delete</span></code> and other functions will only deallocate this item, not its <code class="docutils literal notranslate"><span class="pre">child</span></code>/<code class="docutils literal notranslate"><span class="pre">valuestring</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cJSON_StringIsConst</span></code>: This means that <code class="docutils literal notranslate"><span class="pre">string</span></code> points to a constant string. This means that <code class="docutils literal notranslate"><span class="pre">cJSON_Delete</span></code> and other functions will not try to deallocate <code class="docutils literal notranslate"><span class="pre">string</span></code>.</p></li>
</ul>
</section>
<section id="working-with-the-data-structure">
<h3 id="working-with-the-data-structure">Working with the data structure<a class="headerlink" href="#working-with-the-data-structure" title="Permalink to this headline">¶</a></h3>
<p>For every value type there is a <code class="docutils literal notranslate"><span class="pre">cJSON_Create...</span></code> function that can be used to create an item of that type.
All of these will allocate a <code class="docutils literal notranslate"><span class="pre">cJSON</span></code> struct that can later be deleted with <code class="docutils literal notranslate"><span class="pre">cJSON_Delete</span></code>.
Note that you have to delete them at some point, otherwise you will get a memory leak.<br/>
<strong>Important</strong>: If you have added an item to an array or an object already, you <strong>mustn’t</strong> delete it with <code class="docutils literal notranslate"><span class="pre">cJSON_Delete</span></code>. Adding it to an array or object transfers its ownership so that when that array or object is deleted,
it gets deleted as well. You also could use <code class="docutils literal notranslate"><span class="pre">cJSON_SetValuestring</span></code> to change a <code class="docutils literal notranslate"><span class="pre">cJSON_String</span></code>’s <code class="docutils literal notranslate"><span class="pre">valuestring</span></code>, and you needn’t to free the previous <code class="docutils literal notranslate"><span class="pre">valuestring</span></code> manually.</p>
<section id="basic-types">
<h4 id="basic-types">Basic types<a class="headerlink" href="#basic-types" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p><strong>null</strong> is created with <code class="docutils literal notranslate"><span class="pre">cJSON_CreateNull</span></code></p></li>
<li><p><strong>booleans</strong> are created with <code class="docutils literal notranslate"><span class="pre">cJSON_CreateTrue</span></code>, <code class="docutils literal notranslate"><span class="pre">cJSON_CreateFalse</span></code> or <code class="docutils literal notranslate"><span class="pre">cJSON_CreateBool</span></code></p></li>
<li><p><strong>numbers</strong> are created with <code class="docutils literal notranslate"><span class="pre">cJSON_CreateNumber</span></code>. This will set both <code class="docutils literal notranslate"><span class="pre">valuedouble</span></code> and <code class="docutils literal notranslate"><span class="pre">valueint</span></code>. If the number is outside of the range of an integer, <code class="docutils literal notranslate"><span class="pre">INT_MAX</span></code> or <code class="docutils literal notranslate"><span class="pre">INT_MIN</span></code> are used for <code class="docutils literal notranslate"><span class="pre">valueint</span></code></p></li>
<li><p><strong>strings</strong> are created with <code class="docutils literal notranslate"><span class="pre">cJSON_CreateString</span></code> (copies the string) or with <code class="docutils literal notranslate"><span class="pre">cJSON_CreateStringReference</span></code> (directly points to the string. This means that <code class="docutils literal notranslate"><span class="pre">valuestring</span></code> won’t be deleted by <code class="docutils literal notranslate"><span class="pre">cJSON_Delete</span></code> and you are responsible for its lifetime, useful for constants)</p></li>
</ul>
</section>
<section id="arrays">
<h4 id="arrays">Arrays<a class="headerlink" href="#arrays" title="Permalink to this headline">¶</a></h4>
<p>You can create an empty array with <code class="docutils literal notranslate"><span class="pre">cJSON_CreateArray</span></code>. <code class="docutils literal notranslate"><span class="pre">cJSON_CreateArrayReference</span></code> can be used to create an array that doesn’t “own” its content, so its content doesn’t get deleted by <code class="docutils literal notranslate"><span class="pre">cJSON_Delete</span></code>.</p>
<p>To add items to an array, use <code class="docutils literal notranslate"><span class="pre">cJSON_AddItemToArray</span></code> to append items to the end.
Using <code class="docutils literal notranslate"><span class="pre">cJSON_AddItemReferenceToArray</span></code> an element can be added as a reference to another item, array or string. This means that <code class="docutils literal notranslate"><span class="pre">cJSON_Delete</span></code> will not delete that items <code class="docutils literal notranslate"><span class="pre">child</span></code> or <code class="docutils literal notranslate"><span class="pre">valuestring</span></code> properties, so no double frees are occurring if they are already used elsewhere.
To insert items in the middle, use <code class="docutils literal notranslate"><span class="pre">cJSON_InsertItemInArray</span></code>. It will insert an item at the given 0 based index and shift all the existing items to the right.</p>
<p>If you want to take an item out of an array at a given index and continue using it, use <code class="docutils literal notranslate"><span class="pre">cJSON_DetachItemFromArray</span></code>, it will return the detached item, so be sure to assign it to a pointer, otherwise you will have a memory leak.</p>
<p>Deleting items is done with <code class="docutils literal notranslate"><span class="pre">cJSON_DeleteItemFromArray</span></code>. It works like <code class="docutils literal notranslate"><span class="pre">cJSON_DetachItemFromArray</span></code>, but deletes the detached item via <code class="docutils literal notranslate"><span class="pre">cJSON_Delete</span></code>.</p>
<p>You can also replace an item in an array in place. Either with <code class="docutils literal notranslate"><span class="pre">cJSON_ReplaceItemInArray</span></code> using an index or with <code class="docutils literal notranslate"><span class="pre">cJSON_ReplaceItemViaPointer</span></code> given a pointer to an element. <code class="docutils literal notranslate"><span class="pre">cJSON_ReplaceItemViaPointer</span></code> will return <code class="docutils literal notranslate"><span class="pre">0</span></code> if it fails. What this does internally is to detach the old item, delete it and insert the new item in its place.</p>
<p>To get the size of an array, use <code class="docutils literal notranslate"><span class="pre">cJSON_GetArraySize</span></code>. Use <code class="docutils literal notranslate"><span class="pre">cJSON_GetArrayItem</span></code> to get an element at a given index.</p>
<p>Because an array is stored as a linked list, iterating it via index is inefficient (<code class="docutils literal notranslate"><span class="pre">O(n²)</span></code>), so you can iterate over an array using the <code class="docutils literal notranslate"><span class="pre">cJSON_ArrayForEach</span></code> macro in <code class="docutils literal notranslate"><span class="pre">O(n)</span></code> time complexity.</p>
</section>
<section id="objects">
<h4 id="objects">Objects<a class="headerlink" href="#objects" title="Permalink to this headline">¶</a></h4>
<p>You can create an empty object with <code class="docutils literal notranslate"><span class="pre">cJSON_CreateObject</span></code>. <code class="docutils literal notranslate"><span class="pre">cJSON_CreateObjectReference</span></code> can be used to create an object that doesn’t “own” its content, so its content doesn’t get deleted by <code class="docutils literal notranslate"><span class="pre">cJSON_Delete</span></code>.</p>
<p>To add items to an object, use <code class="docutils literal notranslate"><span class="pre">cJSON_AddItemToObject</span></code>. Use <code class="docutils literal notranslate"><span class="pre">cJSON_AddItemToObjectCS</span></code> to add an item to an object with a name that is a constant or reference (key of the item, <code class="docutils literal notranslate"><span class="pre">string</span></code> in the <code class="docutils literal notranslate"><span class="pre">cJSON</span></code> struct), so that it doesn’t get freed by <code class="docutils literal notranslate"><span class="pre">cJSON_Delete</span></code>.
Using <code class="docutils literal notranslate"><span class="pre">cJSON_AddItemReferenceToArray</span></code> an element can be added as a reference to another object, array or string. This means that <code class="docutils literal notranslate"><span class="pre">cJSON_Delete</span></code> will not delete that items <code class="docutils literal notranslate"><span class="pre">child</span></code> or <code class="docutils literal notranslate"><span class="pre">valuestring</span></code> properties, so no double frees are occurring if they are already used elsewhere.</p>
<p>If you want to take an item out of an object, use <code class="docutils literal notranslate"><span class="pre">cJSON_DetachItemFromObjectCaseSensitive</span></code>, it will return the detached item, so be sure to assign it to a pointer, otherwise you will have a memory leak.</p>
<p>Deleting items is done with <code class="docutils literal notranslate"><span class="pre">cJSON_DeleteItemFromObjectCaseSensitive</span></code>. It works like <code class="docutils literal notranslate"><span class="pre">cJSON_DetachItemFromObjectCaseSensitive</span></code> followed by <code class="docutils literal notranslate"><span class="pre">cJSON_Delete</span></code>.</p>
<p>You can also replace an item in an object in place. Either with <code class="docutils literal notranslate"><span class="pre">cJSON_ReplaceItemInObjectCaseSensitive</span></code> using a key or with <code class="docutils literal notranslate"><span class="pre">cJSON_ReplaceItemViaPointer</span></code> given a pointer to an element. <code class="docutils literal notranslate"><span class="pre">cJSON_ReplaceItemViaPointer</span></code> will return <code class="docutils literal notranslate"><span class="pre">0</span></code> if it fails. What this does internally is to detach the old item, delete it and insert the new item in its place.</p>
<p>To get the size of an object, you can use <code class="docutils literal notranslate"><span class="pre">cJSON_GetArraySize</span></code>, this works because internally objects are stored as arrays.</p>
<p>If you want to access an item in an object, use <code class="docutils literal notranslate"><span class="pre">cJSON_GetObjectItemCaseSensitive</span></code>.</p>
<p>To iterate over an object, you can use the <code class="docutils literal notranslate"><span class="pre">cJSON_ArrayForEach</span></code> macro the same way as for arrays.</p>
<p>cJSON also provides convenient helper functions for quickly creating a new item and adding it to an object, like <code class="docutils literal notranslate"><span class="pre">cJSON_AddNullToObject</span></code>. They return a pointer to the new item or <code class="docutils literal notranslate"><span class="pre">NULL</span></code> if they failed.</p>
</section>
</section>
<section id="parsing-json">
<h3 id="parsing-json">Parsing JSON<a class="headerlink" href="#parsing-json" title="Permalink to this headline">¶</a></h3>
<p>Given some JSON in a zero terminated string, you can parse it with <code class="docutils literal notranslate"><span class="pre">cJSON_Parse</span></code>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">cJSON</span><span class="w"> </span><span class="o">*</span><span class="n">json</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cJSON_Parse</span><span class="p">(</span><span class="n">string</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>Given some JSON in a string (whether zero terminated or not), you can parse it with <code class="docutils literal notranslate"><span class="pre">cJSON_ParseWithLength</span></code>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">cJSON</span><span class="w"> </span><span class="o">*</span><span class="n">json</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cJSON_ParseWithLength</span><span class="p">(</span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">buffer_length</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>It will parse the JSON and allocate a tree of <code class="docutils literal notranslate"><span class="pre">cJSON</span></code> items that represents it. Once it returns, you are fully responsible for deallocating it after use with <code class="docutils literal notranslate"><span class="pre">cJSON_Delete</span></code>.</p>
<p>The allocator used by <code class="docutils literal notranslate"><span class="pre">cJSON_Parse</span></code> is <code class="docutils literal notranslate"><span class="pre">malloc</span></code> and <code class="docutils literal notranslate"><span class="pre">free</span></code> by default but can be changed (globally) with <code class="docutils literal notranslate"><span class="pre">cJSON_InitHooks</span></code>.</p>
<p>If an error occurs a pointer to the position of the error in the input string can be accessed using <code class="docutils literal notranslate"><span class="pre">cJSON_GetErrorPtr</span></code>. Note though that this can produce race conditions in multithreading scenarios, in that case it is better to use <code class="docutils literal notranslate"><span class="pre">cJSON_ParseWithOpts</span></code> with <code class="docutils literal notranslate"><span class="pre">return_parse_end</span></code>.
By default, characters in the input string that follow the parsed JSON will not be considered as an error.</p>
<p>If you want more options, use <code class="docutils literal notranslate"><span class="pre">cJSON_ParseWithOpts(const</span> <span class="pre">char</span> <span class="pre">*value,</span> <span class="pre">const</span> <span class="pre">char</span> <span class="pre">**return_parse_end,</span> <span class="pre">cJSON_bool</span> <span class="pre">require_null_terminated)</span></code>.
<code class="docutils literal notranslate"><span class="pre">return_parse_end</span></code> returns a pointer to the end of the JSON in the input string or the position that an error occurs at (thereby replacing <code class="docutils literal notranslate"><span class="pre">cJSON_GetErrorPtr</span></code> in a thread safe way). <code class="docutils literal notranslate"><span class="pre">require_null_terminated</span></code>, if set to <code class="docutils literal notranslate"><span class="pre">1</span></code> will make it an error if the input string contains data after the JSON.</p>
<p>If you want more options giving buffer length, use <code class="docutils literal notranslate"><span class="pre">cJSON_ParseWithLengthOpts(const</span> <span class="pre">char</span> <span class="pre">*value,</span> <span class="pre">size_t</span> <span class="pre">buffer_length,</span> <span class="pre">const</span> <span class="pre">char</span> <span class="pre">**return_parse_end,</span> <span class="pre">cJSON_bool</span> <span class="pre">require_null_terminated)</span></code>.</p>
</section>
<section id="printing-json">
<h3 id="printing-json">Printing JSON<a class="headerlink" href="#printing-json" title="Permalink to this headline">¶</a></h3>
<p>Given a tree of <code class="docutils literal notranslate"><span class="pre">cJSON</span></code> items, you can print them as a string using <code class="docutils literal notranslate"><span class="pre">cJSON_Print</span></code>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cJSON_Print</span><span class="p">(</span><span class="n">json</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>It will allocate a string and print a JSON representation of the tree into it. Once it returns, you are fully responsible for deallocating it after use with your allocator. (usually <code class="docutils literal notranslate"><span class="pre">free</span></code>, depends on what has been set with <code class="docutils literal notranslate"><span class="pre">cJSON_InitHooks</span></code>).</p>
<p><code class="docutils literal notranslate"><span class="pre">cJSON_Print</span></code> will print with whitespace for formatting. If you want to print without formatting, use <code class="docutils literal notranslate"><span class="pre">cJSON_PrintUnformatted</span></code>.</p>
<p>If you have a rough idea of how big your resulting string will be, you can use <code class="docutils literal notranslate"><span class="pre">cJSON_PrintBuffered(const</span> <span class="pre">cJSON</span> <span class="pre">*item,</span> <span class="pre">int</span> <span class="pre">prebuffer,</span> <span class="pre">cJSON_bool</span> <span class="pre">fmt)</span></code>. <code class="docutils literal notranslate"><span class="pre">fmt</span></code> is a boolean to turn formatting with whitespace on and off. <code class="docutils literal notranslate"><span class="pre">prebuffer</span></code> specifies the first buffer size to use for printing. <code class="docutils literal notranslate"><span class="pre">cJSON_Print</span></code> currently uses 256 bytes for its first buffer size. Once printing runs out of space, a new buffer is allocated and the old gets copied over before printing is continued.</p>
<p>These dynamic buffer allocations can be completely avoided by using <code class="docutils literal notranslate"><span class="pre">cJSON_PrintPreallocated(cJSON</span> <span class="pre">*item,</span> <span class="pre">char</span> <span class="pre">*buffer,</span> <span class="pre">const</span> <span class="pre">int</span> <span class="pre">length,</span> <span class="pre">const</span> <span class="pre">cJSON_bool</span> <span class="pre">format)</span></code>. It takes a buffer to a pointer to print to and its length. If the length is reached, printing will fail and it returns <code class="docutils literal notranslate"><span class="pre">0</span></code>. In case of success, <code class="docutils literal notranslate"><span class="pre">1</span></code> is returned. Note that you should provide 5 bytes more than is actually needed, because cJSON is not 100% accurate in estimating if the provided memory is enough.</p>
</section>
<section id="example">
<h3 id="example">Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p>In this example we want to build and parse the following JSON:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Awesome 4K"</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">"resolutions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">"width"</span><span class="p">:</span><span class="w"> </span><span class="mi">1280</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">"height"</span><span class="p">:</span><span class="w"> </span><span class="mi">720</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">"width"</span><span class="p">:</span><span class="w"> </span><span class="mi">1920</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">"height"</span><span class="p">:</span><span class="w"> </span><span class="mi">1080</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">"width"</span><span class="p">:</span><span class="w"> </span><span class="mi">3840</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">"height"</span><span class="p">:</span><span class="w"> </span><span class="mi">2160</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<section id="printing">
<h4 id="printing">Printing<a class="headerlink" href="#printing" title="Permalink to this headline">¶</a></h4>
<p>Let’s build the above JSON and print it to a string:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">//create a monitor with a list of supported resolutions</span>
<span class="c1">//NOTE: Returns a heap allocated string, you are required to free it after use.</span>
<span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="nf">create_monitor</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">resolution_numbers</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="mi">1280</span><span class="p">,</span><span class="w"> </span><span class="mi">720</span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="mi">1920</span><span class="p">,</span><span class="w"> </span><span class="mi">1080</span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="mi">3840</span><span class="p">,</span><span class="w"> </span><span class="mi">2160</span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">cJSON</span><span class="w"> </span><span class="o">*</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">cJSON</span><span class="w"> </span><span class="o">*</span><span class="n">resolutions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">cJSON</span><span class="w"> </span><span class="o">*</span><span class="n">resolution</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">cJSON</span><span class="w"> </span><span class="o">*</span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">cJSON</span><span class="w"> </span><span class="o">*</span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">cJSON</span><span class="w"> </span><span class="o">*</span><span class="n">monitor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cJSON_CreateObject</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">monitor</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">goto</span><span class="w"> </span><span class="n">end</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cJSON_CreateString</span><span class="p">(</span><span class="s">"Awesome 4K"</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">goto</span><span class="w"> </span><span class="n">end</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="cm">/* after creation was successful, immediately add it to the monitor,</span>
<span class="cm">     * thereby transferring ownership of the pointer to it */</span><span class="w"></span>
<span class="w">    </span><span class="n">cJSON_AddItemToObject</span><span class="p">(</span><span class="n">monitor</span><span class="p">,</span><span class="w"> </span><span class="s">"name"</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">resolutions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cJSON_CreateArray</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">resolutions</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">goto</span><span class="w"> </span><span class="n">end</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">cJSON_AddItemToObject</span><span class="p">(</span><span class="n">monitor</span><span class="p">,</span><span class="w"> </span><span class="s">"resolutions"</span><span class="p">,</span><span class="w"> </span><span class="n">resolutions</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">resolution_numbers</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">)));</span><span class="w"> </span><span class="o">++</span><span class="n">index</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">resolution</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cJSON_CreateObject</span><span class="p">();</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">resolution</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">goto</span><span class="w"> </span><span class="n">end</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="n">cJSON_AddItemToArray</span><span class="p">(</span><span class="n">resolutions</span><span class="p">,</span><span class="w"> </span><span class="n">resolution</span><span class="p">);</span><span class="w"></span>

<span class="w">        </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cJSON_CreateNumber</span><span class="p">(</span><span class="n">resolution_numbers</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="mi">0</span><span class="p">]);</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">width</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">goto</span><span class="w"> </span><span class="n">end</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="n">cJSON_AddItemToObject</span><span class="p">(</span><span class="n">resolution</span><span class="p">,</span><span class="w"> </span><span class="s">"width"</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="p">);</span><span class="w"></span>

<span class="w">        </span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cJSON_CreateNumber</span><span class="p">(</span><span class="n">resolution_numbers</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="mi">1</span><span class="p">]);</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">height</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">goto</span><span class="w"> </span><span class="n">end</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="n">cJSON_AddItemToObject</span><span class="p">(</span><span class="n">resolution</span><span class="p">,</span><span class="w"> </span><span class="s">"height"</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cJSON_Print</span><span class="p">(</span><span class="n">monitor</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="w"> </span><span class="s">"Failed to print monitor.</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="nl">end</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="n">cJSON_Delete</span><span class="p">(</span><span class="n">monitor</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">string</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Alternatively we can use the <code class="docutils literal notranslate"><span class="pre">cJSON_Add...ToObject</span></code> helper functions to make our lifes a little easier:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">//NOTE: Returns a heap allocated string, you are required to free it after use.</span>
<span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="nf">create_monitor_with_helpers</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">resolution_numbers</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="mi">1280</span><span class="p">,</span><span class="w"> </span><span class="mi">720</span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="mi">1920</span><span class="p">,</span><span class="w"> </span><span class="mi">1080</span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="mi">3840</span><span class="p">,</span><span class="w"> </span><span class="mi">2160</span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">cJSON</span><span class="w"> </span><span class="o">*</span><span class="n">resolutions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">cJSON</span><span class="w"> </span><span class="o">*</span><span class="n">monitor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cJSON_CreateObject</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cJSON_AddStringToObject</span><span class="p">(</span><span class="n">monitor</span><span class="p">,</span><span class="w"> </span><span class="s">"name"</span><span class="p">,</span><span class="w"> </span><span class="s">"Awesome 4K"</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">goto</span><span class="w"> </span><span class="n">end</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="n">resolutions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cJSON_AddArrayToObject</span><span class="p">(</span><span class="n">monitor</span><span class="p">,</span><span class="w"> </span><span class="s">"resolutions"</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">resolutions</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">goto</span><span class="w"> </span><span class="n">end</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">resolution_numbers</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">)));</span><span class="w"> </span><span class="o">++</span><span class="n">index</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">cJSON</span><span class="w"> </span><span class="o">*</span><span class="n">resolution</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cJSON_CreateObject</span><span class="p">();</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cJSON_AddNumberToObject</span><span class="p">(</span><span class="n">resolution</span><span class="p">,</span><span class="w"> </span><span class="s">"width"</span><span class="p">,</span><span class="w"> </span><span class="n">resolution_numbers</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">goto</span><span class="w"> </span><span class="n">end</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cJSON_AddNumberToObject</span><span class="p">(</span><span class="n">resolution</span><span class="p">,</span><span class="w"> </span><span class="s">"height"</span><span class="p">,</span><span class="w"> </span><span class="n">resolution_numbers</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">goto</span><span class="w"> </span><span class="n">end</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="n">cJSON_AddItemToArray</span><span class="p">(</span><span class="n">resolutions</span><span class="p">,</span><span class="w"> </span><span class="n">resolution</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cJSON_Print</span><span class="p">(</span><span class="n">monitor</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="w"> </span><span class="s">"Failed to print monitor.</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="nl">end</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="n">cJSON_Delete</span><span class="p">(</span><span class="n">monitor</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">string</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="parsing">
<h4 id="parsing">Parsing<a class="headerlink" href="#parsing" title="Permalink to this headline">¶</a></h4>
<p>In this example we will parse a JSON in the above format and check if the monitor supports a Full HD resolution while printing some diagnostic output:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* return 1 if the monitor supports full hd, 0 otherwise */</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="nf">supports_full_hd</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">monitor</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cJSON</span><span class="w"> </span><span class="o">*</span><span class="n">resolution</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cJSON</span><span class="w"> </span><span class="o">*</span><span class="n">resolutions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cJSON</span><span class="w"> </span><span class="o">*</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">cJSON</span><span class="w"> </span><span class="o">*</span><span class="n">monitor_json</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cJSON_Parse</span><span class="p">(</span><span class="n">monitor</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">monitor_json</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">error_ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cJSON_GetErrorPtr</span><span class="p">();</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">error_ptr</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="w"> </span><span class="s">"Error before: %s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="w"> </span><span class="n">error_ptr</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">goto</span><span class="w"> </span><span class="n">end</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cJSON_GetObjectItemCaseSensitive</span><span class="p">(</span><span class="n">monitor_json</span><span class="p">,</span><span class="w"> </span><span class="s">"name"</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cJSON_IsString</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="o">-&gt;</span><span class="n">valuestring</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">))</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">"Checking monitor </span><span class="se">\"</span><span class="s">%s</span><span class="se">\"\n</span><span class="s">"</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="o">-&gt;</span><span class="n">valuestring</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="n">resolutions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cJSON_GetObjectItemCaseSensitive</span><span class="p">(</span><span class="n">monitor_json</span><span class="p">,</span><span class="w"> </span><span class="s">"resolutions"</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">cJSON_ArrayForEach</span><span class="p">(</span><span class="n">resolution</span><span class="p">,</span><span class="w"> </span><span class="n">resolutions</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">cJSON</span><span class="w"> </span><span class="o">*</span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cJSON_GetObjectItemCaseSensitive</span><span class="p">(</span><span class="n">resolution</span><span class="p">,</span><span class="w"> </span><span class="s">"width"</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">cJSON</span><span class="w"> </span><span class="o">*</span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cJSON_GetObjectItemCaseSensitive</span><span class="p">(</span><span class="n">resolution</span><span class="p">,</span><span class="w"> </span><span class="s">"height"</span><span class="p">);</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">cJSON_IsNumber</span><span class="p">(</span><span class="n">width</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="n">cJSON_IsNumber</span><span class="p">(</span><span class="n">height</span><span class="p">))</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">goto</span><span class="w"> </span><span class="n">end</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">width</span><span class="o">-&gt;</span><span class="n">valuedouble</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1920</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">height</span><span class="o">-&gt;</span><span class="n">valuedouble</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1080</span><span class="p">))</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">goto</span><span class="w"> </span><span class="n">end</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="nl">end</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="n">cJSON_Delete</span><span class="p">(</span><span class="n">monitor_json</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">status</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Note that there are no NULL checks except for the result of <code class="docutils literal notranslate"><span class="pre">cJSON_Parse</span></code> because <code class="docutils literal notranslate"><span class="pre">cJSON_GetObjectItemCaseSensitive</span></code> checks for <code class="docutils literal notranslate"><span class="pre">NULL</span></code> inputs already, so a <code class="docutils literal notranslate"><span class="pre">NULL</span></code> value is just propagated and <code class="docutils literal notranslate"><span class="pre">cJSON_IsNumber</span></code> and <code class="docutils literal notranslate"><span class="pre">cJSON_IsString</span></code> return <code class="docutils literal notranslate"><span class="pre">0</span></code> if the input is <code class="docutils literal notranslate"><span class="pre">NULL</span></code>.</p>
</section>
</section>
<section id="caveats">
<h3 id="caveats">Caveats<a class="headerlink" href="#caveats" title="Permalink to this headline">¶</a></h3>
<section id="zero-character">
<h4 id="zero-character">Zero Character<a class="headerlink" href="#zero-character" title="Permalink to this headline">¶</a></h4>
<p>cJSON doesn’t support strings that contain the zero character <code class="docutils literal notranslate"><span class="pre">'\0'</span></code> or <code class="docutils literal notranslate"><span class="pre">\u0000</span></code>. This is impossible with the current API because strings are zero terminated.</p>
</section>
<section id="character-encoding">
<h4 id="character-encoding">Character Encoding<a class="headerlink" href="#character-encoding" title="Permalink to this headline">¶</a></h4>
<p>cJSON only supports UTF-8 encoded input. In most cases it doesn’t reject invalid UTF-8 as input though, it just propagates it through as is. As long as the input doesn’t contain invalid UTF-8, the output will always be valid UTF-8.</p>
</section>
<section id="c-standard">
<h4 id="c-standard">C Standard<a class="headerlink" href="#c-standard" title="Permalink to this headline">¶</a></h4>
<p>cJSON is written in ANSI C (or C89, C90). If your compiler or C library doesn’t follow this standard, correct behavior is not guaranteed.</p>
<p>NOTE: ANSI C is not C++ therefore it shouldn’t be compiled with a C++ compiler. You can compile it with a C compiler and link it with your C++ code however. Although compiling with a C++ compiler might work, correct behavior is not guaranteed.</p>
</section>
<section id="floating-point-numbers">
<h4 id="floating-point-numbers">Floating Point Numbers<a class="headerlink" href="#floating-point-numbers" title="Permalink to this headline">¶</a></h4>
<p>cJSON does not officially support any <code class="docutils literal notranslate"><span class="pre">double</span></code> implementations other than IEEE754 double precision floating point numbers. It might still work with other implementations but bugs with these will be considered invalid.</p>
<p>The maximum length of a floating point literal that cJSON supports is currently 63 characters.</p>
</section>
<section id="deep-nesting-of-arrays-and-objects">
<h4 id="deep-nesting-of-arrays-and-objects">Deep Nesting Of Arrays And Objects<a class="headerlink" href="#deep-nesting-of-arrays-and-objects" title="Permalink to this headline">¶</a></h4>
<p>cJSON doesn’t support arrays and objects that are nested too deeply because this would result in a stack overflow. To prevent this cJSON limits the depth to <code class="docutils literal notranslate"><span class="pre">CJSON_NESTING_LIMIT</span></code> which is 1000 by default but can be changed at compile time.</p>
</section>
<section id="thread-safety">
<h4 id="thread-safety">Thread Safety<a class="headerlink" href="#thread-safety" title="Permalink to this headline">¶</a></h4>
<p>In general cJSON is <strong>not thread safe</strong>.</p>
<p>However it is thread safe under the following conditions:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cJSON_GetErrorPtr</span></code> is never used (the <code class="docutils literal notranslate"><span class="pre">return_parse_end</span></code> parameter of <code class="docutils literal notranslate"><span class="pre">cJSON_ParseWithOpts</span></code> can be used instead)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cJSON_InitHooks</span></code> is only ever called before using cJSON in any threads.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">setlocale</span></code> is never called before all calls to cJSON functions have returned.</p></li>
</ul>
</section>
<section id="case-sensitivity">
<h4 id="case-sensitivity">Case Sensitivity<a class="headerlink" href="#case-sensitivity" title="Permalink to this headline">¶</a></h4>
<p>When cJSON was originally created, it didn’t follow the JSON standard and didn’t make a distinction between uppercase and lowercase letters. If you want the correct, standard compliant, behavior, you need to use the <code class="docutils literal notranslate"><span class="pre">CaseSensitive</span></code> functions where available.</p>
</section>
<section id="duplicate-object-members">
<h4 id="duplicate-object-members">Duplicate Object Members<a class="headerlink" href="#duplicate-object-members" title="Permalink to this headline">¶</a></h4>
<p>cJSON supports parsing and printing JSON that contains objects that have multiple members with the same name. <code class="docutils literal notranslate"><span class="pre">cJSON_GetObjectItemCaseSensitive</span></code> however will always only return the first one.</p>
</section>
</section>
</section>
</section>
<section id="enjoy-cjson">
<h1 id="enjoy-cjson">Enjoy cJSON!<a class="headerlink" href="#enjoy-cjson" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>Dave Gamble (original author)</p></li>
<li><p>Max Bruckner and Alan Wang (current maintainer)</p></li>
<li><p>and the other <a class="reference internal" href="CONTRIBUTORS.html"><span class="doc std std-doc">cJSON contributors</span></a></p></li>
</ul>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2022, ljx.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 4.3.2.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../../../static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>